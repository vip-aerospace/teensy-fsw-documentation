<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.7"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Ke Ao Teensy Flight Software: Artemis::Devices::CurrentSensors Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Ke Ao Teensy Flight Software
   </div>
   <div id="projectbrief">The software on the Teensy in the Ke Ao cubesat.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.7 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('classArtemis_1_1Devices_1_1CurrentSensors.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="classArtemis_1_1Devices_1_1CurrentSensors-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">Artemis::Devices::CurrentSensors Class Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aece84002218dc12ddfe9c63a61dbe0d8"><td class="memItemLeft" align="right" valign="top">int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classArtemis_1_1Devices_1_1CurrentSensors.html#aece84002218dc12ddfe9c63a61dbe0d8">setup</a> (void)</td></tr>
<tr class="memdesc:aece84002218dc12ddfe9c63a61dbe0d8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets up I2C connection to current sensors.  <br /></td></tr>
<tr class="separator:aece84002218dc12ddfe9c63a61dbe0d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0df8c03e3d54b2cde6fa39d8bf04092c"><td class="memItemLeft" align="right" valign="top">int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classArtemis_1_1Devices_1_1CurrentSensors.html#a0df8c03e3d54b2cde6fa39d8bf04092c">read</a> (uint32_t uptime)</td></tr>
<tr class="memdesc:a0df8c03e3d54b2cde6fa39d8bf04092c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads current sensors and generates two packets on both RFM23 and Astrodev queues.  <br /></td></tr>
<tr class="separator:a0df8c03e3d54b2cde6fa39d8bf04092c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a35634e1edcdeea7ba3da81409d325534"><td class="memItemLeft" align="right" valign="top">std::map&lt; std::string, Adafruit_INA219 * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classArtemis_1_1Devices_1_1CurrentSensors.html#a35634e1edcdeea7ba3da81409d325534">current_sensors</a></td></tr>
<tr class="memdesc:a35634e1edcdeea7ba3da81409d325534"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mapping between current sensor string names and current sensor objects.  <br /></td></tr>
<tr class="separator:a35634e1edcdeea7ba3da81409d325534"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a0df8c03e3d54b2cde6fa39d8bf04092c" name="a0df8c03e3d54b2cde6fa39d8bf04092c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0df8c03e3d54b2cde6fa39d8bf04092c">&#9670;&#160;</a></span>read()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32_t Artemis::Devices::CurrentSensors::read </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>uptime</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads current sensors and generates two packets on both RFM23 and Astrodev queues. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">uptime</td><td>The time, in milliseconds, that the Teensy has been powered on. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int32_t Always returns 0. </dd></dl>
<p>It is possible to poll the remaining current sensors if one has not been set up.</p>
<p>A single packet is used in this function. It is copied as needed. Two current beacons are created, to hold all the current measurements.</p>
<p>The packet's header information is filled out, identifying the originator node, destination node, and packet type.</p>
<p>The current sensors are iterated over. Each sensor is polled for its bus voltage and current. The first few sensors, defined by <a class="el" href="artemis__defs_8h.html#a69799b0a5a16e327c77608d3cae7dbb0">ARTEMIS_CURRENT_BEACON_1_COUNT</a>, are stored in the first current beacon's array, with the remainder stored in the second current beacon's array.</p>
<p>The first beacon is given an identifier value, then copied into the into the payload of the packet. The packet is then copied into the RFM23 and Astrodev queues for transmission.</p>
<p>The second beacon is given an identifier value, then copied into the into the payload of the packet. The packet is then copied into the RFM23 and Astrodev queues for transmission.</p>

</div>
</div>
<a id="aece84002218dc12ddfe9c63a61dbe0d8" name="aece84002218dc12ddfe9c63a61dbe0d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aece84002218dc12ddfe9c63a61dbe0d8">&#9670;&#160;</a></span>setup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32_t Artemis::Devices::CurrentSensors::setup </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets up I2C connection to current sensors. </p>
<dl class="section return"><dt>Returns</dt><dd>int32_t Returns 0 if sucessful, -1 if failed.</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000027">Todo:</a></b></dt><dd>go through library and see what we need to configure and callibrate </dd></dl>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a35634e1edcdeea7ba3da81409d325534" name="a35634e1edcdeea7ba3da81409d325534"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a35634e1edcdeea7ba3da81409d325534">&#9670;&#160;</a></span>current_sensors</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt;std::string, Adafruit_INA219 *&gt; Artemis::Devices::CurrentSensors::current_sensors</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">                {<span class="stringliteral">&quot;solar_panel_1&quot;</span>, <span class="keyword">new</span> Adafruit_INA219(0x40)},</div>
<div class="line">                {<span class="stringliteral">&quot;solar_panel_2&quot;</span>, <span class="keyword">new</span> Adafruit_INA219(0x41)},</div>
<div class="line">                {<span class="stringliteral">&quot;solar_panel_3&quot;</span>, <span class="keyword">new</span> Adafruit_INA219(0x42)},</div>
<div class="line">                {<span class="stringliteral">&quot;solar_panel_4&quot;</span>, <span class="keyword">new</span> Adafruit_INA219(0x43)},</div>
<div class="line">                {<span class="stringliteral">&quot;battery_board&quot;</span>, <span class="keyword">new</span> Adafruit_INA219(0x44)},</div>
<div class="line">            }</div>
</div><!-- fragment -->
<p>Mapping between current sensor string names and current sensor objects. </p>
<p>Each current sensor is instantiated as an Adafruit INA219 current sensor object. These objects are initialized with I2C addresses, allowing the sensors to share the I2C bus.</p>
<p>The mapping is as follows:</p><ul>
<li>"solar_panel_1" to 0x40</li>
<li>"solar_panel_2" to 0x41</li>
<li>"solar_panel_3" to 0x42</li>
<li>"solar_panel_4" to 0x43</li>
<li>"battery_board" to 0x44 </li>
</ul>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>teensy_fsw/include/<a class="el" href="artemis__devices_8h_source.html">artemis_devices.h</a></li>
<li>teensy_fsw/src/<a class="el" href="artemis__devices_8cpp.html">artemis_devices.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><b>Artemis</b></li><li class="navelem"><a class="el" href="namespaceArtemis_1_1Devices.html">Devices</a></li><li class="navelem"><a class="el" href="classArtemis_1_1Devices_1_1CurrentSensors.html">CurrentSensors</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.7 </li>
  </ul>
</div>
</body>
</html>
